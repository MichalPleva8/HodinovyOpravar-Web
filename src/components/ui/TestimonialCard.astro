---
/**
 * TestimonialCard Component
 *
 * Displays customer testimonials with rating stars, quote text, and author information.
 * Includes optional avatar support.
 *
 * @example
 * <TestimonialCard
 *   name="Ján Novák"
 *   location="Žilina"
 *   rating={5}
 *   text="Výborná práca, rýchla reakcia. Opravil mi vodovodné potrubie za pár hodín."
 * />
 */

interface Props {
  name: string;
  location: string;
  rating: number; // 1-5
  text: string;
  avatar?: string;
}

const { name, location, rating, text, avatar } = Astro.props;

// Generate array for star rendering
const stars = Array.from({ length: 5 }, (_, i) => i < rating);
---

<div class="bg-white rounded-card p-6 shadow-card h-full flex flex-col">
  <!-- Rating Stars -->
  <div class="flex gap-1 mb-4">
    {stars.map((filled) => (
      <svg
        class={`w-5 h-5 ${filled ? 'text-secondary-yellow fill-current' : 'text-neutral-300 fill-current'}`}
        viewBox="0 0 24 24"
      >
        <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z" />
      </svg>
    ))}
  </div>

  <!-- Testimonial Text -->
  <p class="text-body text-neutral-700 mb-6 italic flex-grow">
    "{text}"
  </p>

  <!-- Author Info -->
  <div class="flex items-center gap-3 mt-auto">
    {avatar ? (
      <img src={avatar} alt={name} class="w-12 h-12 rounded-full object-cover" />
    ) : (
      <div class="w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center flex-shrink-0">
        <span class="text-primary font-bold text-lg">
          {name.charAt(0)}
        </span>
      </div>
    )}

    <div>
      <p class="font-bold text-neutral-800">{name}</p>
      <p class="text-sm text-neutral-600">{location}</p>
    </div>
  </div>
</div>
