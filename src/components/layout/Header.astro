---
// src/components/layout/Header.astro
import { Phone, Menu, Facebook, Instagram, Linkedin } from 'lucide-react'
import TopBar from './TopBar.astro'
import Button from '../ui/Button.astro'
import { socials } from '../../data/socials'

const socialIcons = {
	facebook: Facebook,
	twitter: Facebook,
	instagram: Instagram,
	youtube: Facebook,
	linkedin: Linkedin,
}

const navigation = [
	{ name: 'Domov', href: '/' },
	{ name: 'Služby', href: '/sluzby' },
	{ name: 'Kontakt', href: '/kontakt' },
]

const currentPath = Astro.url.pathname
---

<>
	<TopBar />
	<div class="main-nav z-50 border-b border-neutral-300 bg-white">
		<nav class="container mx-auto px-6 py-4">
			<div class="flex items-center justify-between">
				<!-- Logo -->
				<a href="/" class="flex items-center">
					<img src="/images/logo.png" alt="Hodinový opravár" class="h-12" />
				</a>

				<!-- Desktop Navigation + CTA -->
				<div class="hidden items-center gap-8 md:flex">
					<!-- Navigation Links -->
					<ul class="flex items-center gap-8">
						{
							navigation.map((item) => (
								<li>
									<a
										href={item.href}
										class={`text-body font-medium transition-colors ${
											currentPath === item.href
												? 'text-primary font-bold'
												: 'hover:text-primary text-neutral-700'
										}`}
									>
										{item.name}
									</a>
								</li>
							))
						}
					</ul>

					<!-- CTA Button -->
					<Button href="tel:+421903566644" variant="primary" size="sm" class="gap-2">
						<Phone className="h-5 w-5" />
						Zavolať teraz
					</Button>
				</div>

				<!-- Mobile Menu Button -->
				<button
					class="hover:text-primary p-2 text-neutral-700 transition-colors md:hidden"
					aria-label="Otvoriť menu"
					id="mobile-menu-button"
				>
					<Menu className="h-6 w-6" />
				</button>
			</div>
		</nav>
	</div>

	<!-- Mobile Navigation Overlay (below header) -->
	<div
		id="mobile-menu"
		class="fixed left-0 right-0 top-[72px] z-40 h-[calc(100vh-72px)] bg-white shadow-lg transition-transform duration-300 ease-in-out md:hidden"
		style="transform: translateY(-100%);"
	>
		<div class="flex h-full flex-col justify-between overflow-y-auto px-6 pt-8 pb-12">
			<ul class="flex flex-col space-y-2">
				{
					navigation.map((item) => (
						<li>
							<a
								href={item.href}
								class={`text-body block rounded-lg px-4 py-2 font-medium transition-colors ${
									currentPath === item.href
										? 'bg-primary-light text-primary font-bold'
										: 'text-neutral-700 hover:bg-neutral-200'
								}`}
							>
								{item.name}
							</a>
						</li>
					))
				}
			</ul>

			<div>
				<!-- Social Links -->
				<div class="flex items-center justify-center gap-4">
					{
						socials.map((social) => {
							const Icon = socialIcons[social.icon]
							return (
								<a
									href={social.url}
									target="_blank"
									rel="noopener noreferrer"
									aria-label={social.name}
									class="group flex h-10 w-10 items-center justify-center rounded-full bg-neutral-100 transition-all hover:bg-primary"
								>
									<Icon className="h-5 w-5 text-primary transition-colors group-hover:text-white" />
								</a>
							)
						})
					}
				</div>

				<!-- Mobile CTA Button -->
				<div class="mt-6">
					<Button
						href="tel:+421903566644"
						variant="primary"
						size="md"
						class="w-full gap-2"
					>
						<Phone className="h-5 w-5" />
						Zavolať teraz
					</Button>
				</div>
			</div>
		</div>
	</div>
</>

<style>
	/* Mobile: Fixed positioning */
	.main-nav {
		position: fixed;
		top: 0;
		left: 0;
		right: 0;
	}

	/* Desktop: Sticky positioning */
	@media (min-width: 768px) {
		.main-nav {
			position: sticky;
			top: 0;
			left: auto;
			right: auto;
		}
	}
</style>

<script>
	// Mobile menu toggle with slide animation
	document.addEventListener('DOMContentLoaded', () => {
		const menuButton = document.getElementById('mobile-menu-button')
		const mobileMenu = document.getElementById('mobile-menu')

		menuButton?.addEventListener('click', () => {
			const currentTransform = mobileMenu?.style.transform || 'translateY(-100%)'
			const isOpen = currentTransform === 'translateY(0%)'

			if (isOpen) {
				// Close menu
				if (mobileMenu) {
					mobileMenu.style.transform = 'translateY(-100%)'
				}
			} else {
				// Open menu
				if (mobileMenu) {
					mobileMenu.style.transform = 'translateY(0%)'
				}
			}
		})
	})
</script>
