---
// src/components/layout/Header.astro
import { Phone, Menu } from 'lucide-react'
import TopBar from './TopBar.astro'
import Button from '../ui/Button.astro'

const navigation = [
	{ name: 'Domov', href: '/' },
	{ name: 'Služby', href: '/sluzby' },
	{ name: 'Kontakt', href: '/kontakt' },
]

const currentPath = Astro.url.pathname
---

<>
	<TopBar />
	<div class="main-nav z-50 border-b border-neutral-300 bg-white">
		<nav class="container mx-auto px-6 py-4">
			<div class="flex items-center justify-between">
				<!-- Logo -->
				<a href="/" class="flex items-center">
					<img src="/images/logo.png" alt="Hodinový opravár" class="h-12" />
				</a>

				<!-- Desktop Navigation + CTA -->
				<div class="hidden items-center gap-8 md:flex">
					<!-- Navigation Links -->
					<ul class="flex items-center gap-8">
						{
							navigation.map((item) => (
								<li>
									<a
										href={item.href}
										class={`text-body font-medium transition-colors ${
											currentPath === item.href
												? 'text-primary font-bold'
												: 'hover:text-primary text-neutral-700'
										}`}
									>
										{item.name}
									</a>
								</li>
							))
						}
					</ul>

					<!-- CTA Button -->
					<Button href="tel:+421903566644" variant="primary" size="sm" class="gap-2">
						<Phone className="h-5 w-5" />
						Zavolať teraz
					</Button>
				</div>

				<!-- Mobile Menu Button -->
				<button
					class="hover:text-primary p-2 text-neutral-700 transition-colors md:hidden"
					aria-label="Otvoriť menu"
					id="mobile-menu-button"
				>
					<Menu className="h-6 w-6" />
				</button>
			</div>

			<!-- Mobile Navigation (hidden by default, toggle with JS) -->
			<div
				id="mobile-menu"
				class="grid grid-rows-[0fr] overflow-hidden transition-[grid-template-rows] duration-300 ease-in-out md:hidden"
			>
				<div class="overflow-hidden pt-4 pb-2">
				<ul class="flex flex-col space-y-2">
					{
						navigation.map((item) => (
							<li>
								<a
									href={item.href}
									class={`text-body block rounded-lg px-4 py-2 font-medium transition-colors ${
										currentPath === item.href
											? 'bg-primary-light text-primary font-bold'
											: 'text-neutral-700 hover:bg-neutral-200'
									}`}
								>
									{item.name}
								</a>
							</li>
						))
					}
				</ul>

				<!-- Mobile CTA Button -->
				<div class="mt-4 px-4">
					<Button
						href="tel:+421903566644"
						variant="primary"
						size="md"
						class="w-full gap-2"
					>
						<Phone className="h-5 w-5" />
						Zavolať teraz
					</Button>
				</div>
				</div>
			</div>
		</nav>
	</div>
</>

<style>
	/* Mobile: Fixed positioning */
	.main-nav {
		position: fixed;
		top: 0;
		left: 0;
		right: 0;
	}

	/* Desktop: Sticky positioning */
	@media (min-width: 768px) {
		.main-nav {
			position: sticky;
			top: 0;
			left: auto;
			right: auto;
		}
	}
</style>

<script>
	// Mobile menu toggle with animation
	document.addEventListener('DOMContentLoaded', () => {
		const menuButton = document.getElementById('mobile-menu-button')
		const mobileMenu = document.getElementById('mobile-menu')

		menuButton?.addEventListener('click', () => {
			const isOpen = mobileMenu?.classList.contains('grid-rows-[1fr]')

			if (isOpen) {
				// Close menu
				mobileMenu?.classList.remove('grid-rows-[1fr]')
				mobileMenu?.classList.add('grid-rows-[0fr]')
			} else {
				// Open menu
				mobileMenu?.classList.remove('grid-rows-[0fr]')
				mobileMenu?.classList.add('grid-rows-[1fr]')
			}
		})
	})
</script>
